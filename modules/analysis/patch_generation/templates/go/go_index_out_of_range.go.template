// Add bounds check before array access
if ${index} < len(${array}) {
    ${code_snippet}
} else {
    return fmt.Errorf("index %d out of bounds for array of length %d", ${index}, len(${array}))
}