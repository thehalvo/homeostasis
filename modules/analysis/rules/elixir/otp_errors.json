{
  "rules": [
    {
      "id": "otp_supervisor_error",
      "pattern": "\\*\\* \\(RuntimeError\\) (.*?)Supervisor(.*?)\\.init/1 (.*)",
      "type": "RuntimeError",
      "description": "Error initializing a supervisor",
      "root_cause": "otp_supervisor_error",
      "suggestion": "Check your supervisor specification, especially child_spec format. Ensure supervisor strategy (one_for_one, one_for_all, etc.) is appropriate for your application.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_genserver_cast_error",
      "pattern": "\\*\\* \\(exit\\) exited in: GenServer\\.(.*?)cast\\(([^,]+), ([^\\)]+)\\)(.*)",
      "type": "GenServer.CastError",
      "description": "Error when casting a message to a GenServer process",
      "root_cause": "otp_genserver_cast_error",
      "suggestion": "Check that the GenServer process is still alive before casting. If the process might be down, use `GenServer.whereis/1` or `Process.alive?/1` before casting, or consider using a call which will return an error.",
      "confidence": "high",
      "severity": "medium",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_genserver_call_error",
      "pattern": "\\*\\* \\(exit\\) exited in: GenServer\\.(.*?)call\\(([^,]+), ([^\\)]+)\\)(.*)",
      "type": "GenServer.CallError",
      "description": "Error or timeout when calling a GenServer process",
      "root_cause": "otp_genserver_call_error",
      "suggestion": "Check that the GenServer process is alive and processing messages. Consider increasing the timeout if the operation is known to take a long time. Watch for deadlocks caused by synchronous calls between GenServers.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_terminate_error",
      "pattern": "\\*\\* \\(stop\\) (.*?)in (GenServer|GenStateMachine|GenStage)(.*?)terminate/2",
      "type": "TerminateError",
      "description": "Error in terminate callback of a process",
      "root_cause": "otp_terminate_error",
      "suggestion": "Handle errors properly in your terminate/2 callback. Remember that terminate/2 is called during normal shutdown as well as errors.",
      "confidence": "high",
      "severity": "medium",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_child_spec_error",
      "pattern": "\\*\\* \\(ArgumentError\\) (.*?)invalid child specification: (.*)",
      "type": "ArgumentError",
      "description": "Invalid child specification in supervisor",
      "root_cause": "otp_child_spec_error",
      "suggestion": "Check your child_spec format. Make sure it has the required :id, :start keys at minimum. If using {Module, arg}, ensure Module implements child_spec/1.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_registry_error",
      "pattern": "\\*\\* \\(Registry\\.(.*?)Error\\) (.*)",
      "type": "Registry.Error",
      "description": "Error with Registry operations",
      "root_cause": "otp_registry_error",
      "suggestion": "Check registry name and operation type. Make sure the registry is started before trying to use it.",
      "confidence": "high",
      "severity": "medium",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_application_start_error",
      "pattern": "\\*\\* \\(Mix\\.Error\\) (.*?)Could not start application ([^:]+): (.*)",
      "type": "Mix.Error", 
      "description": "Failed to start an application",
      "root_cause": "otp_application_start_error",
      "suggestion": "Check application dependencies and ensure they're started first. Look at the error message for specific reasons the application didn't start.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_task_error",
      "pattern": "\\*\\* \\(exit\\) (.*?)Task (.*?) (.*)",
      "type": "Task.Error",
      "description": "Error in a Task process",
      "root_cause": "otp_task_error",
      "suggestion": "Handle errors in your Task by using Task.await/2 with a try/rescue block, or use Task.Supervisor to isolate task failures from your main application.",
      "confidence": "high",
      "severity": "medium",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_dynamic_supervisor_error",
      "pattern": "\\*\\* \\(RuntimeError\\) (.*?)DynamicSupervisor(.*?)(.*)",
      "type": "RuntimeError",
      "description": "Error with DynamicSupervisor operation",
      "root_cause": "otp_dynamic_supervisor_error",
      "suggestion": "Check child specifications passed to DynamicSupervisor.start_child/2. Ensure the DynamicSupervisor is started and running.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_exit_signal_error",
      "pattern": "\\*\\* \\(exit\\) (.*?) process (.*?) (.*?) trap_exit: (.*?) links: (.*)",
      "type": "ExitSignalError",
      "description": "Unhandled exit signal in a linked process",
      "root_cause": "otp_exit_signal_error",
      "suggestion": "Set process flag trap_exit to true if you want to handle exit signals, or supervise the process with a supervisor. Consider using Process.monitor/1 instead of links if you only want to be notified of a process termination.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_gen_state_machine_error",
      "pattern": "\\*\\* \\(exit\\) (.*?)GenStateMachine(.*?)(.*)",
      "type": "GenStateMachine.Error",
      "description": "Error in a Gen State Machine",
      "root_cause": "otp_gen_state_machine_error",
      "suggestion": "Check your state transitions and event handling. Make sure your callback mode (:state_functions or :handle_event_function) matches your implementation.",
      "confidence": "high",
      "severity": "medium",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_gen_stage_error",
      "pattern": "\\*\\* \\(exit\\) (.*?)GenStage(.*?)(.*)",
      "type": "GenStage.Error",
      "description": "Error in a Gen Stage process",
      "root_cause": "otp_gen_stage_error",
      "suggestion": "Check producer-consumer subscription setup and demand handling. Ensure events are properly processed and demand is requested appropriately.",
      "confidence": "high",
      "severity": "medium",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_callback_error",
      "pattern": "\\*\\* \\(UndefinedFunctionError\\) (.*?) callback ([^/]+)/\\d+ required by behaviour ([^ ]+) is not implemented",
      "type": "UndefinedFunctionError",
      "description": "Missing required callback implementation for a behaviour",
      "root_cause": "otp_callback_error",
      "suggestion": "Implement all required callbacks for the behaviour. Check the behaviour documentation to see the required callbacks and their specifications.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_supervisor_start_error",
      "pattern": "\\*\\* \\(exit\\) an exception was raised:.*?Supervisor\\.start_link/[23].*?\\(\\w+\\)",
      "type": "SupervisorError",
      "description": "Error starting a supervisor",
      "root_cause": "otp_supervisor_start_error",
      "suggestion": "Check the Supervisor module strategy and child specifications. Ensure all required modules for child processes are available.",
      "confidence": "high",
      "severity": "high",
      "category": "otp",
      "framework": "otp"
    },
    {
      "id": "otp_max_restarts_error",
      "pattern": "\\*\\* \\(exit\\) reached maximum restart intensity",
      "type": "SupervisorError",
      "description": "Supervisor reached the maximum restart intensity",
      "root_cause": "otp_max_restarts_error",
      "suggestion": "Investigate why child processes are crashing repeatedly. Consider increasing max_restarts and max_seconds if appropriate, but fix the underlying issue causing repeated crashes.",
      "confidence": "high",
      "severity": "critical",
      "category": "otp",
      "framework": "otp"
    }
  ]
}