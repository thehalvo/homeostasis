{
  "name": "PHP Core Error Rules",
  "description": "Rules for detecting and fixing common PHP errors",
  "version": "0.1.0",
  "rules": [
    {
      "id": "php_undefined_variable",
      "pattern": "Undefined variable\\s*:\\s*\\$(\\w+)",
      "type": "E_NOTICE",
      "description": "Undefined variable accessed",
      "root_cause": "php_undefined_variable",
      "suggestion": "Initialize the variable before using it or check with isset() if it exists. Consider using null coalescing operator (??) for fallback values.",
      "confidence": "high",
      "severity": "medium",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_undefined_method",
      "pattern": "Call to undefined method ([\\w\\\\]+)::([\\w]+)\\(\\)",
      "type": "E_ERROR",
      "description": "Call to a method that doesn't exist",
      "root_cause": "php_undefined_method",
      "suggestion": "Check method name for typos. Verify the class implements the method or use method_exists() to check before calling.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_undefined_function",
      "pattern": "Call to undefined function ([\\w\\\\]+)\\(\\)",
      "type": "E_ERROR",
      "description": "Call to a function that doesn't exist",
      "root_cause": "php_undefined_function",
      "suggestion": "Check function name for typos. Ensure the required extension is installed or the function is properly imported.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_null_reference",
      "pattern": "Call to a member function ([\\w]+)\\(\\) on null",
      "type": "E_ERROR",
      "description": "Attempted to call a method on a null object",
      "root_cause": "php_null_reference",
      "suggestion": "Add null check before calling methods on potentially null variables. Use null safe operator (?->) in PHP 8+ or use optional chaining pattern.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_type_error",
      "pattern": "TypeError: Argument (\\d+) passed to ([\\w\\\\]+)::([\\w]+)\\(\\) must be of (the type|type) ([\\w]+), ([\\w]+) given",
      "type": "TypeError",
      "description": "Function called with incorrect argument type",
      "root_cause": "php_type_error",
      "suggestion": "Ensure correct type is passed to the function. Use type casting or validation before passing the argument. In PHP 7+, consider adding type declarations to functions.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_syntax_error",
      "pattern": "Parse error: syntax error, unexpected ([^,]+)( in |,)",
      "type": "E_PARSE",
      "description": "PHP code contains syntax errors",
      "root_cause": "php_syntax_error",
      "suggestion": "Fix the syntax issue. Common issues include missing semicolons, unbalanced brackets, or incorrect PHP tags.",
      "confidence": "high",
      "severity": "high",
      "category": "syntax",
      "framework": "php"
    },
    {
      "id": "php_index_error",
      "pattern": "Undefined (index|offset|array key):\\s*([^\\s]+)",
      "type": "E_NOTICE",
      "description": "Attempted to access an array index that doesn't exist",
      "root_cause": "php_undefined_index",
      "suggestion": "Check if the index exists with isset() or array_key_exists() before accessing it. Use null coalescing operator (??) for fallback values.",
      "confidence": "high",
      "severity": "medium",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_require_error",
      "pattern": "Failed opening required '([^']+)'",
      "type": "E_COMPILE_ERROR",
      "description": "Failed to require a file",
      "root_cause": "php_missing_file",
      "suggestion": "Check the file path is correct. Ensure the file exists and is readable by the web server.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_class_not_found",
      "pattern": "Class '([^']+)' not found",
      "type": "E_ERROR",
      "description": "Referenced a class that doesn't exist",
      "root_cause": "php_missing_class",
      "suggestion": "Check class name for typos. Ensure the class file is included/required or properly autoloaded. Verify namespace declarations.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_autoload_error",
      "pattern": "spl_autoload_call\\(\\):\\s*failed to open stream",
      "type": "E_ERROR",
      "description": "Class autoloader failed to load a class",
      "root_cause": "php_autoload_error",
      "suggestion": "Check autoloader configuration. Ensure namespace and directory structure match PSR-4 standards. Verify composer dump-autoload has been run.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_division_by_zero",
      "pattern": "Division by zero",
      "type": "E_WARNING",
      "description": "Attempted to divide by zero",
      "root_cause": "php_division_by_zero",
      "suggestion": "Add a check to ensure the divisor is not zero before performing division.",
      "confidence": "high",
      "severity": "medium",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_memory_limit",
      "pattern": "Allowed memory size of (\\d+) bytes exhausted",
      "type": "E_ERROR",
      "description": "Script exceeded memory limit",
      "root_cause": "php_memory_limit",
      "suggestion": "Optimize memory usage in the script. Consider increasing memory_limit in php.ini for memory-intensive operations.",
      "confidence": "high",
      "severity": "high",
      "category": "runtime",
      "framework": "php"
    },
    {
      "id": "php_max_execution_time",
      "pattern": "Maximum execution time of (\\d+) seconds exceeded",
      "type": "E_ERROR",
      "description": "Script execution timed out",
      "root_cause": "php_timeout",
      "suggestion": "Optimize script performance. For long-running tasks, consider breaking them into smaller chunks or using background processing.",
      "confidence": "high",
      "severity": "high",
      "category": "runtime",
      "framework": "php"
    },
    {
      "id": "php_pdo_error",
      "pattern": "SQLSTATE\\[([^\\]]+)\\]",
      "type": "PDOException",
      "description": "Database operation failed",
      "root_cause": "php_database_error",
      "suggestion": "Check SQL syntax. Verify database credentials and connection parameters. Consider using prepared statements to prevent SQL injection.",
      "confidence": "high",
      "severity": "high",
      "category": "database",
      "framework": "php"
    },
    {
      "id": "php_undefined_property",
      "pattern": "Undefined property:\\s+([\\w\\\\]+)::\\$(\\w+)",
      "type": "E_NOTICE",
      "description": "Attempted to access a property that doesn't exist",
      "root_cause": "php_undefined_property",
      "suggestion": "Initialize class properties in the constructor. Check property names for typos. Use property_exists() or isset() to check if a property exists.",
      "confidence": "high",
      "severity": "medium",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_access_level_error",
      "pattern": "Cannot access (private|protected) property|method ([\\w\\\\]+)::\\$(\\w+)",
      "type": "E_ERROR",
      "description": "Attempted to access a private or protected member",
      "root_cause": "php_access_level_error",
      "suggestion": "Check the access level of the property or method. Use accessor methods (getters/setters) instead of direct access.",
      "confidence": "high",
      "severity": "medium",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_redeclare_error",
      "pattern": "Cannot redeclare ([\\w\\\\]+)::(\\w+)\\(\\)",
      "type": "E_ERROR",
      "description": "Function or method declared more than once",
      "root_cause": "php_redeclare_error",
      "suggestion": "Ensure functions and classes are only included once. Use include_once or require_once. Check for duplicate method declarations in class hierarchies.",
      "confidence": "high",
      "severity": "high",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_headers_already_sent",
      "pattern": "Warning: Cannot modify header information - headers already sent",
      "type": "E_WARNING",
      "description": "Attempted to set HTTP headers after output has been sent",
      "root_cause": "php_headers_already_sent",
      "suggestion": "Ensure all header() calls come before any output (HTML, whitespace, etc.). Check for BOM markers or whitespace before <?php tags.",
      "confidence": "high",
      "severity": "medium",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_missing_argument",
      "pattern": "Warning: Missing argument (\\d+) for ([\\w\\\\]+)::(\\w+)\\(\\)",
      "type": "E_WARNING",
      "description": "Function called with fewer arguments than required",
      "root_cause": "php_missing_argument",
      "suggestion": "Provide all required arguments to the function. Use default parameter values for optional arguments.",
      "confidence": "high",
      "severity": "medium",
      "category": "core",
      "framework": "php"
    },
    {
      "id": "php_namespace_error",
      "pattern": "Fatal error: Namespace declaration statement has to be the very first statement",
      "type": "E_ERROR",
      "description": "Namespace declaration not at the beginning of the file",
      "root_cause": "php_namespace_error",
      "suggestion": "Move the namespace declaration to the beginning of the file, before any other code.",
      "confidence": "high",
      "severity": "high",
      "category": "syntax",
      "framework": "php"
    }
  ]
}