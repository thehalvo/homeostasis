{
  "name": "Laravel Error Rules",
  "description": "Rules for detecting and fixing Laravel framework errors",
  "version": "0.1.0",
  "rules": [
    {
      "id": "laravel_model_not_found",
      "pattern": "Illuminate\\\\Database\\\\Eloquent\\\\ModelNotFoundException.*No query results for model \\[([^\\]]+)\\]",
      "type": "ModelNotFoundException",
      "description": "Attempted to find a model that doesn't exist",
      "root_cause": "laravel_model_not_found",
      "suggestion": "Use findOrFail() with try/catch or find() with a null check. Consider using firstOrNew(), firstOrCreate(), or updateOrCreate() for operations that might need to create records.",
      "confidence": "high",
      "severity": "medium",
      "category": "database",
      "framework": "laravel"
    },
    {
      "id": "laravel_validation_failed",
      "pattern": "Illuminate\\\\Validation\\\\ValidationException.*The given data was invalid",
      "type": "ValidationException",
      "description": "Form validation failed for user input",
      "root_cause": "laravel_validation_error",
      "suggestion": "Ensure proper validation rules are defined. Add clear validation error messages. Use old() helper to preserve input on validation failure.",
      "confidence": "high",
      "severity": "medium",
      "category": "validation",
      "framework": "laravel"
    },
    {
      "id": "laravel_route_not_found",
      "pattern": "Symfony\\\\Component\\\\HttpKernel\\\\Exception\\\\NotFoundHttpException.*The requested resource was not found",
      "type": "NotFoundHttpException",
      "description": "No route found for the requested URL",
      "root_cause": "laravel_route_not_found",
      "suggestion": "Check your routes configuration in routes/web.php or routes/api.php. Ensure the route URL and HTTP method are correctly defined.",
      "confidence": "high",
      "severity": "medium",
      "category": "routing",
      "framework": "laravel"
    },
    {
      "id": "laravel_query_exception",
      "pattern": "Illuminate\\\\Database\\\\QueryException.*SQLSTATE\\[([^\\]]+)\\]",
      "type": "QueryException",
      "description": "Database query failed due to SQL error",
      "root_cause": "laravel_query_exception",
      "suggestion": "Check SQL syntax in queries. Ensure database migrations are up to date. Use parameter binding instead of string concatenation for queries to prevent SQL injection.",
      "confidence": "high",
      "severity": "high",
      "category": "database",
      "framework": "laravel"
    },
    {
      "id": "laravel_method_not_allowed",
      "pattern": "Symfony\\\\Component\\\\HttpKernel\\\\Exception\\\\MethodNotAllowedHttpException",
      "type": "MethodNotAllowedHttpException",
      "description": "HTTP method not allowed for the given route",
      "root_cause": "laravel_method_not_allowed",
      "suggestion": "Verify the HTTP method (GET, POST, PUT, DELETE) used matches the route definition. Use the appropriate method in forms and AJAX requests.",
      "confidence": "high",
      "severity": "medium",
      "category": "routing",
      "framework": "laravel"
    },
    {
      "id": "laravel_mass_assignment",
      "pattern": "Illuminate\\\\Database\\\\Eloquent\\\\MassAssignmentException",
      "type": "MassAssignmentException",
      "description": "Mass assignment protection prevented setting attributes",
      "root_cause": "laravel_mass_assignment",
      "suggestion": "Add attributes to the $fillable array in the model or use $guarded to specify which attributes are not mass assignable.",
      "confidence": "high",
      "severity": "high",
      "category": "database",
      "framework": "laravel"
    },
    {
      "id": "laravel_authentication_exception",
      "pattern": "Illuminate\\\\Auth\\\\AuthenticationException",
      "type": "AuthenticationException",
      "description": "Unauthenticated user tried to access a protected route",
      "root_cause": "laravel_authentication_exception",
      "suggestion": "Add auth middleware to protected routes. Use @auth/@guest directives in Blade templates. Redirect unauthenticated users to the login page.",
      "confidence": "high",
      "severity": "high",
      "category": "authentication",
      "framework": "laravel"
    },
    {
      "id": "laravel_authorization_exception",
      "pattern": "Illuminate\\\\Auth\\\\Access\\\\AuthorizationException",
      "type": "AuthorizationException",
      "description": "User does not have permission to perform an action",
      "root_cause": "laravel_authorization_exception",
      "suggestion": "Define proper policies and gates. Use can() and authorize() methods to check permissions before performing actions.",
      "confidence": "high",
      "severity": "high",
      "category": "authorization",
      "framework": "laravel"
    },
    {
      "id": "laravel_view_not_found",
      "pattern": "Illuminate\\\\View\\\\ViewException.*View \\[([^\\]]+)\\] not found",
      "type": "ViewException",
      "description": "Referenced view template does not exist",
      "root_cause": "laravel_view_not_found",
      "suggestion": "Check view name and path. Create the missing view file or use a view that exists. Verify the correct view directory is being used.",
      "confidence": "high",
      "severity": "medium",
      "category": "view",
      "framework": "laravel"
    },
    {
      "id": "laravel_csrf_token_mismatch",
      "pattern": "Illuminate\\\\Session\\\\TokenMismatchException",
      "type": "TokenMismatchException",
      "description": "CSRF token mismatch or session expired",
      "root_cause": "laravel_csrf_token_mismatch",
      "suggestion": "Add @csrf directive to forms. Ensure session lifetime is appropriate. For AJAX requests, include the X-CSRF-TOKEN header.",
      "confidence": "high",
      "severity": "medium",
      "category": "security",
      "framework": "laravel"
    },
    {
      "id": "laravel_relation_not_found",
      "pattern": "BadMethodCallException: Call to undefined relationship \\[([^\\]]+)\\]",
      "type": "BadMethodCallException",
      "description": "Attempted to access an undefined relationship on a model",
      "root_cause": "laravel_relation_not_found",
      "suggestion": "Define the relationship method in the model class. Check for typos in relationship name.",
      "confidence": "high",
      "severity": "medium",
      "category": "database",
      "framework": "laravel"
    },
    {
      "id": "laravel_migration_error",
      "pattern": "Illuminate\\\\Database\\\\Migrations\\\\Migration.*failed",
      "type": "PDOException",
      "description": "Database migration failed",
      "root_cause": "laravel_migration_error",
      "suggestion": "Check migration file syntax. Ensure migrations are run in the correct order. Consider using foreign key constraint options like onDelete('cascade').",
      "confidence": "high",
      "severity": "high",
      "category": "database",
      "framework": "laravel"
    },
    {
      "id": "laravel_environment_config",
      "pattern": "InvalidArgumentException: No application encryption key has been specified",
      "type": "InvalidArgumentException",
      "description": "Missing application encryption key",
      "root_cause": "laravel_environment_config",
      "suggestion": "Run 'php artisan key:generate' to create an application key. Ensure .env file exists and is properly configured.",
      "confidence": "high",
      "severity": "high",
      "category": "configuration",
      "framework": "laravel"
    },
    {
      "id": "laravel_mail_driver_error",
      "pattern": "Swift_TransportException",
      "type": "Swift_TransportException",
      "description": "Error sending email",
      "root_cause": "laravel_mail_driver_error",
      "suggestion": "Check mail configuration in config/mail.php and .env. Verify SMTP credentials and connection settings.",
      "confidence": "high",
      "severity": "medium",
      "category": "mail",
      "framework": "laravel"
    },
    {
      "id": "laravel_queue_connection_error",
      "pattern": "Illuminate\\\\Queue\\\\InvalidConnectionException",
      "type": "InvalidConnectionException",
      "description": "Invalid queue connection configuration",
      "root_cause": "laravel_queue_connection_error",
      "suggestion": "Check queue configuration in config/queue.php and .env. Ensure the specified connection exists and is properly configured.",
      "confidence": "high",
      "severity": "high",
      "category": "queue",
      "framework": "laravel"
    }
  ]
}